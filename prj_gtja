摘要：在本次POC中我们使用FusionInsight的特征工程，以及大数据挖掘的技术对微融资的潜在用户进行了挖掘，无论是短名单的绝对质量还是与之前SPSS结果的横向比较中都取得了很好的效果。微融资的自然开通比例为3.7，我们短名单最高开通比例为41.5%，推广短名单的准确率比基线最高提高了10倍，可以为业务部门提高最高1000%的推广效果。在与前期SPSS的Logit模型，以及业务部门经验规则生成的短名单横向比较中，我们模型效果提高了3.5到5倍。在附加对两融客户触及强制平仓警戒线的预测中，我们在很短的时间内（一天）就把我们在微融资客户挖掘中构建的特征复用在另外一个问题上，并取得了很准确的预测结果，显示了我们特征复用的简易性，可以大幅降低数据挖掘前期数据处理的成本。

步骤：
分割样本
训练模型
对用户排序
生成短名单
预测测试样本
计算实际购买用户的比例

1. 问题
在本POC开始之前，XXXX已通过短信以及APP的方式进行了一轮大覆盖面，低成本的微融资业务推广。 经过这轮推广已有2.95万用户开通微融资资质，其中2.21万已使用过微融资业务。但是对于XXXX超过400万的用户来说开通微融资的用户比例还是很低的，尚有很大潜力可挖。
短信推送已经被运营商，网站，各大金融机构等拥有用户手机号码的企业滥用。用户每天可能会收到很多没有营养的推送短信，所以短信推送信息很大比例都被用户忽略。 APP推送的效果较短信推送好，但是也有类似问题。而电话推送成本高，且推送给不需要的客户的时候会影响用户体验。
本次POC的目的是在有资格办理用户的名单中，挖掘出一份潜在用户占比很高（相对基线）的短名单，供给市场部门做高效推送用。

2. 目标与评估
本次POC的目标是生成含金量（潜在用户比例）很高的短名单。因为本次POC时间较紧，我们不可能让市场部门通过实际推广来评估。所以这次POC我们只能把客户数据集按照20%-80%的比例随机分为测试数据集和训练数据集。用训练样本训练模型，再用此模型预测测试样本中用户申请微融资的可能性，然后把用户按照购买的可能性由大到小排序，生成不同长度的短名单，最后根据不同长度短名单中实际已开通微融资用户的比例评估模型。整个流程如右图所示
在效果评估中我们会与自然开通率，以及业务专家规则的效果进行比较。自然开通率是指已开通用户占所有有资格开通用户的比例。而业务专家规则是业务部门专家根据其经验提出的比较可能开通微融资用户的特征。

3. 方法
在精准营销中，我们一般把没有使用业务的用户叫做负样本，而使用过业务的用户叫做正样本。在大部分新产品的精准营销都有一个共同的问题，那就是负样本不明确。所谓不明确就是，我们并不清楚一个推送有覆盖但是没有购买产品的用户是不是真的对这个产品不感兴趣还是根本就没看推送内容。对于短信推送来说，完全没看推送短信的可能性是很高的。
负样本不明确对此次POC的影响是，我们用分类机算出来，用户开通微融资概率的绝对值没有意义，只有排序有意义。排序的意义在于，可能性越高的用户和已经购买了该产品用户的特征更相似，应该优先推送。这样决策树，随机森林，SVM这类结果直接是是否的分类机完全不可用，而Naïve Bayesian因为过拟合的问题也不在优选范围之内。那剩下的就只有KNN和Logit回归了，因为KNN的准确度不高（Terrell & Scott, 1）我们选用了Logit回归模型。
Logit模型被广泛的用于二分类数据挖掘问题。因为其计算复杂度较低，且灵活度很高， Logit模型也是大数据挖掘领域最受欢迎的分类机。百度宣称其维护的Logit回归模型有300亿维。理论上来说如果使用泰勒展开式（即多项式）logit回归可以表达任意形状的潜在函数，所以如果应用得当的话其准确度不输于任何其他分类机。关于Logit回归的详细介绍在附录1.
由于我们计划使用大量用户的交易行为作为特征，过拟合和无关特征成为我们的主要问题。在数据挖掘中应对此类问题最常用的是Stepwise Regression（Hurvich & Tsai, 2）。但是因为Stepwise 每删掉一个无关特征都需要对所有特征进行一次检验，而Logit回归中最常用的似然值比例检验，每次检验需要重新训练一次模型，对于我们数千特征数量的模型来说，Stepwise的时间成本太高。所以我们使用了Lasso-Logit回归（Tibshirani, 4 Meier & Bühlmann, 5）。同时我们也在小范围内用Stepwise 检验了Lasso-Logit的一致性。Lasso模型的详细介绍在附录2.

4. 数据
本次POC的样本集是所有符合微融资的客户，样本总量为785513。 这些用户是在XXXX460万用户中选取标的资产总值高于10万的用户。其中已办理微融资的客户有29160。其中正样本占总样本数的3.7%。主要数据来自于以下8张表，数据处理总共用了7天左右的时间。



DDW.PROFIT_CUST_PROFIT_HIS
Jz30.TCL_H_ORDERREC
Olap.TB_FACT_CAP_ASSET_BY_DAY
Jz30.TCL_LOAN_RIGHT
SPSS.WEIRONG_CUST_ASSETINFO_HALFYEAR
SPSS.XIAODAI_TRANS_CUST
SPSS.WEIRONG_LIST_CUST_DAXIN
Olap.TB_DIM_CUST_INFO

我们选取的用户特征一共分为四大类。第一类为客户静态的数值型特征，这类特征包括：
客户人民币账户余额半年均值
客户人民币账户股票价值半年最大值
客户半年注入资金总值
佣金总和

第二类是客户静态的枚举型特征
客户开户分支机构

第三类是客户客户的流水型特征，其中交易和总值特征从2014.06.13-2015.06.13共247个交易日。回报取了2014.05.01-2015.06.13，5日回报
每日卖单成交金额
每日买单成交金额
每日账户总值
每5日投资回报

第四类是衍生特征，衍生特征又分为两类，一个是高次项，另一个是交叉项。加入这些项的目的一个目的是为了模拟出泰勒展开式。因为Logit模型只能抓住特征与概率之间的线性关系，为了抓住非线性关系就要使用泰勒展开式。另一个目的是为了抓住时间序列数据的序列相关（autoregression）在模型中我们使用了跨期交叉。


5. 结果
本次POC在785513个样本中随机选出了20%的样本作为检验样本，80%作为训练样本。检验样本总数是154693，其中正样本有5795个。正样本约占总样本数的3.7%。用户特征总数为5556。
本次POC的目的是生成尽可能准确的短名单，所以考核目标首先是已知正样本占短名单的比例。图1中的红线是不同短名单长度下已知正样本所占比例。请注意：由于我们只用了20%的数据做测试，同样精度全数据量短名单的长度要乘5。这个指标可以简易的理解为，确定短名单之后短名单内每个客户注册微融资的可能性。图1中的绿线是短名单正样本数占所有正样本的比例。这条线可以简易的理解为此短名单对已知潜在客户的覆盖率。
由图1 我们可以看出准确率和名单长度成负向关系，而覆盖率和名单长度成正向关系。 正所谓鱼和熊掌不能兼得，推广方必须在两者中找到一个平衡点。全数据短名单长度为10000时（即测试短名单为2000时），短名单准确率为36.4%，而潜在用户覆盖率为12.56%。具体各阶段短名单长度与准确率，实际用户覆盖率如表1

短名单长度
准确率
覆盖率
1000
41.50%
7.16%
2000
36.40%
12.56%
6000
27.31%
28.28%
12000
21.28%
44.06%
16000
18.72%
51.70%

表1最后一行的含义是经过我们模型的筛选，只需要向10%的客户推荐微融资就能覆盖超过50%的潜在客户。
以上讨论的是累积的准确度，我们在方法中讨论过Logit回归预测出的几率的绝对值是没有意义的（因为我们之前提到的负样本不明确的问题），只有排序有意义。但是我们通过分段的准确度可以给出每个段内预测的准确度。图2表现的是不同排名区间客户购买产品的可能性。

由图2可见在总排名0-5000（1000*5，1000附近）的时候用户购买的可能性高达41.5%。相对于3.7%的基数来说这是很高的了。在2万-2.5万（5000附近）的时候可能性降到了20.3%。而在15万（30000附近）的时候就降到了6%。

6. 大数据的红利
以上是我们短名单的绝对准确度，本部分，我们将会拿我们的大数据模型的结果和之前已有模型结果做比较。一共有三个模型，每个模型都有自己的候选集，也都生成了各自的短名单。
1） 传统Logit回归模型
传统Logit回归模型的候选集为15万人，和我们候选集的交集为6.5万人。据王博说数量差异的原因是，他在生成候选集时没有严格考虑用户是不是有申请微融资的资格。 传统Logit模型生成短名单长度是1万人，和我们候选集的交集是8975人。些许差异的原因是标的资产的变化。
传统Logit回归的短名单是用5月底的数据生成的，目的是交给业务部门推广。所以其中只会包括之后开通微融资业务的客户。为了保持基线一致，我们把候选集和短名单中在6月1日前开通微融资的客户过滤掉。这样两个模型比拼的仅仅是6月1日到6月23日间开通微融资的客户的预测。比较的结果如下表
